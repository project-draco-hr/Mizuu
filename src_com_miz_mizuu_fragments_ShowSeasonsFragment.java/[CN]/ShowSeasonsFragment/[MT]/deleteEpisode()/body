{
  AlertDialog.Builder builder=new AlertDialog.Builder(getActivity());
  View dialogLayout=getActivity().getLayoutInflater().inflate(R.layout.delete_file_dialog_layout,null);
  final CheckBox cb=(CheckBox)dialogLayout.findViewById(R.id.deleteFile);
  builder.setTitle(getString(R.string.removeEpisode) + " S" + shownEpisodes.get(selectedEpisodeIndex).getSeason()+ "E"+ shownEpisodes.get(selectedEpisodeIndex).getEpisode()).setView(dialogLayout).setCancelable(false).setPositiveButton(getString(android.R.string.yes),new DialogInterface.OnClickListener(){
    public void onClick(    DialogInterface dialog,    int id){
      DbAdapterTvShowEpisode dbHelper=MizuuApplication.getTvEpisodeDbAdapter();
      boolean deleted=false;
      if (ignoreDeletedFiles)       deleted=dbHelper.ignoreEpisode(shownEpisodes.get(selectedEpisodeIndex).getRowId());
 else       deleted=dbHelper.deleteEpisode(shownEpisodes.get(selectedEpisodeIndex).getRowId());
      if (deleted) {
        try {
          File episodePhoto=new File(MizLib.getTvShowEpisodeFolder(getActivity()),shownEpisodes.get(selectedEpisodeIndex).getShowId() + "_S" + shownEpisodes.get(selectedEpisodeIndex).getSeason()+ "E"+ shownEpisodes.get(selectedEpisodeIndex).getEpisode()+ ".jpg");
          if (episodePhoto.exists()) {
            MizLib.deleteFile(episodePhoto);
          }
        }
 catch (        NullPointerException e) {
        }
        if (dbHelper.getEpisodeCount(shownEpisodes.get(selectedEpisodeIndex).getShowId()) == 0) {
          DbAdapterTvShow dbShow=MizuuApplication.getTvDbAdapter();
          boolean deletedShow=dbShow.deleteShow(shownEpisodes.get(selectedEpisodeIndex).getShowId());
          if (deletedShow) {
            MizLib.deleteFile(new File(MizLib.getTvShowThumbFolder(getActivity()),shownEpisodes.get(selectedEpisodeIndex).getShowId() + ".jpg"));
            MizLib.deleteFile(new File(MizLib.getTvShowBackdropFolder(getActivity()),shownEpisodes.get(selectedEpisodeIndex).getShowId() + "_tvbg.jpg"));
          }
        }
        if (cb.isChecked()) {
          Intent deleteIntent=new Intent(getActivity(),DeleteFile.class);
          deleteIntent.putExtra("filepath",shownEpisodes.get(selectedEpisodeIndex).getFilepath());
          getActivity().startService(deleteIntent);
        }
        notifyDatasetChanges();
        getActivity().finish();
      }
 else {
        Toast.makeText(getActivity(),getString(R.string.failedToRemoveEpisode),Toast.LENGTH_SHORT).show();
      }
    }
  }
).setNegativeButton(getString(android.R.string.no),new DialogInterface.OnClickListener(){
    public void onClick(    DialogInterface dialog,    int id){
      dialog.cancel();
    }
  }
).show();
}
