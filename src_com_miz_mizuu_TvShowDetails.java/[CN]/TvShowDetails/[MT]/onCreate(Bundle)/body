{
  super.onCreate(savedInstanceState);
  mBus=MizuuApplication.getBus();
  if (isFullscreen())   setTheme(R.style.Mizuu_Theme_Transparent_NoBackGround_FullScreen);
 else   setTheme(R.style.Mizuu_Theme_NoBackGround_Transparent);
  if (MizLib.isPortrait(this)) {
    getWindow().setBackgroundDrawableResource(R.drawable.bg);
  }
  getWindow().requestFeature(Window.FEATURE_ACTION_BAR_OVERLAY);
  setContentView(R.layout.viewpager);
  mActionBarOverlay=(ImageView)findViewById(R.id.actionbar_overlay);
  mActionBarOverlay.setLayoutParams(new FrameLayout.LayoutParams(LayoutParams.MATCH_PARENT,isFullscreen() ? MizLib.getActionBarHeight(this) : MizLib.getActionBarAndStatusBarHeight(this)));
  mActionBar=getActionBar();
  mActionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_LIST);
  if (spinnerAdapter == null)   spinnerAdapter=new ActionBarSpinner(this,spinnerItems);
  setTitle(null);
  mViewPager=(ViewPager)findViewById(R.id.awesomepager);
  mViewPager.setOffscreenPageLimit(3);
  mViewPager.setAdapter(new ShowDetailsAdapter(getSupportFragmentManager()));
  mViewPager.setOnPageChangeListener(new ViewPager.SimpleOnPageChangeListener(){
    @Override public void onPageSelected(    int position){
      mActionBar.setSelectedNavigationItem(position);
      invalidateOptionsMenu();
      updateActionBarDrawable(1,false,false);
    }
  }
);
  ignorePrefixes=PreferenceManager.getDefaultSharedPreferences(this).getBoolean(IGNORED_TITLE_PREFIXES,false);
  dbHelper=MizuuApplication.getTvDbAdapter();
  String showId="";
  if (Intent.ACTION_SEARCH.equals(getIntent().getAction())) {
    showId=getIntent().getStringExtra(SearchManager.EXTRA_DATA_KEY);
  }
 else {
    showId=getIntent().getStringExtra("showId");
  }
  Cursor cursor=dbHelper.getShow(showId);
  try {
    while (cursor.moveToNext()) {
      thisShow=new TvShow(this,cursor.getString(cursor.getColumnIndex(DbAdapterTvShows.KEY_SHOW_ID)),cursor.getString(cursor.getColumnIndex(DbAdapterTvShows.KEY_SHOW_TITLE)),cursor.getString(cursor.getColumnIndex(DbAdapterTvShows.KEY_SHOW_PLOT)),cursor.getString(cursor.getColumnIndex(DbAdapterTvShows.KEY_SHOW_RATING)),cursor.getString(cursor.getColumnIndex(DbAdapterTvShows.KEY_SHOW_GENRES)),cursor.getString(cursor.getColumnIndex(DbAdapterTvShows.KEY_SHOW_ACTORS)),cursor.getString(cursor.getColumnIndex(DbAdapterTvShows.KEY_SHOW_CERTIFICATION)),cursor.getString(cursor.getColumnIndex(DbAdapterTvShows.KEY_SHOW_FIRST_AIRDATE)),cursor.getString(cursor.getColumnIndex(DbAdapterTvShows.KEY_SHOW_RUNTIME)),ignorePrefixes,cursor.getString(cursor.getColumnIndex(DbAdapterTvShows.KEY_SHOW_FAVOURITE)),MizuuApplication.getTvEpisodeDbAdapter().getLatestEpisodeAirdate(cursor.getString(cursor.getColumnIndex(DbAdapterTvShows.KEY_SHOW_ID))));
    }
  }
 catch (  Exception e) {
    finish();
    return;
  }
 finally {
    cursor.close();
  }
  if (thisShow == null) {
    finish();
    return;
  }
  setupSpinnerItems();
  if (savedInstanceState != null) {
    mViewPager.setCurrentItem(savedInstanceState.getInt("tab",0));
  }
  if (!PreferenceManager.getDefaultSharedPreferences(this).getString(TVSHOWS_START_PAGE,getString(R.string.showDetails)).equals(getString(R.string.showDetails)))   mViewPager.setCurrentItem(1);
}
