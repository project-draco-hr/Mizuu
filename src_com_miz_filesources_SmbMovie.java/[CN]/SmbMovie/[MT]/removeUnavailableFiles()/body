{
  DbAdapterMovies db=MizuuApplication.getMovieAdapter();
  List<DbMovie> dbMovies=getDbMovies(), deletedMovies=new ArrayList<DbMovie>();
  ArrayList<FileSource> filesources=MizLib.getFileSources(MizLib.TYPE_MOVIE,true);
  FileSource source;
  boolean deleted;
  SmbFile temp;
  int count=dbMovies.size();
  if (MizLib.isWifiConnected(getContext())) {
    for (int i=0; i < count; i++) {
      if (dbMovies.get(i).isNetworkFile() && !dbMovies.get(i).hasOfflineCopy()) {
        try {
          source=null;
          for (int j=0; j < filesources.size(); j++)           if (dbMovies.get(i).getFilepath().contains(filesources.get(j).getFilepath())) {
            source=filesources.get(j);
            continue;
          }
          if (source == null) {
            deleted=db.deleteMovie(dbMovies.get(i).getTmdbId());
            if (deleted)             deletedMovies.add(dbMovies.get(i));
            continue;
          }
          temp=new SmbFile(MizLib.createSmbLoginString(URLEncoder.encode(source.getDomain(),"utf-8"),URLEncoder.encode(source.getUser(),"utf-8"),URLEncoder.encode(source.getPassword(),"utf-8"),dbMovies.get(i).getFilepath(),false));
          if (!temp.exists()) {
            deleted=db.deleteMovie(dbMovies.get(i).getTmdbId());
            if (deleted)             deletedMovies.add(dbMovies.get(i));
          }
        }
 catch (        Exception e) {
        }
      }
    }
  }
  count=deletedMovies.size();
  for (int i=0; i < count; i++) {
    if (!db.movieExists(deletedMovies.get(i).getTmdbId())) {
      MizLib.deleteFile(new File(deletedMovies.get(i).getThumbnail()));
      MizLib.deleteFile(new File(deletedMovies.get(i).getBackdrop()));
    }
  }
  deletedMovies.clear();
  filesources.clear();
}
