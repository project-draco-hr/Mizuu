{
  mBus=MizuuApplication.getBus();
  if (isFullscreen())   setTheme(R.style.Mizuu_Theme_NoBackground_FullScreen);
 else   setTheme(R.style.Mizuu_Theme_NoBackground);
  if (MizLib.isPortrait(this)) {
    getWindow().setBackgroundDrawableResource(R.drawable.bg);
  }
  getWindow().requestFeature(Window.FEATURE_ACTION_BAR_OVERLAY);
  super.onCreate(savedInstanceState);
  mActionBar=getActionBar();
  mShowId=getIntent().getExtras().getString(SHOW_ID);
  mSeason=getIntent().getExtras().getInt("season");
  mEpisode=getIntent().getExtras().getInt("episode");
  mDatabaseHelper=MizuuApplication.getTvEpisodeDbAdapter();
  Cursor cursor=mDatabaseHelper.getAllEpisodes(mShowId,DbAdapterTvShowEpisodes.OLDEST_FIRST);
  try {
    while (cursor.moveToNext()) {
      mEpisodes.add(new TvShowEpisode(this,mShowId,cursor.getString(cursor.getColumnIndex(DbAdapterTvShowEpisodes.KEY_EPISODE_TITLE)),cursor.getString(cursor.getColumnIndex(DbAdapterTvShowEpisodes.KEY_EPISODE_PLOT)),cursor.getString(cursor.getColumnIndex(DbAdapterTvShowEpisodes.KEY_SEASON)),cursor.getString(cursor.getColumnIndex(DbAdapterTvShowEpisodes.KEY_EPISODE)),cursor.getString(cursor.getColumnIndex(DbAdapterTvShowEpisodes.KEY_EPISODE_AIRDATE)),cursor.getString(cursor.getColumnIndex(DbAdapterTvShowEpisodes.KEY_EPISODE_DIRECTOR)),cursor.getString(cursor.getColumnIndex(DbAdapterTvShowEpisodes.KEY_EPISODE_WRITER)),cursor.getString(cursor.getColumnIndex(DbAdapterTvShowEpisodes.KEY_EPISODE_GUESTSTARS)),cursor.getString(cursor.getColumnIndex(DbAdapterTvShowEpisodes.KEY_EPISODE_RATING)),cursor.getString(cursor.getColumnIndex(DbAdapterTvShowEpisodes.KEY_HAS_WATCHED)),cursor.getString(cursor.getColumnIndex(DbAdapterTvShowEpisodes.KEY_FAVOURITE))));
    }
  }
 catch (  Exception e) {
  }
 finally {
    cursor.close();
  }
  mShowTitle=MizuuApplication.getTvDbAdapter().getShowTitle(mShowId);
  mActionBar.setTitle(mShowTitle);
  mViewPager=(ViewPager)findViewById(R.id.awesomepager);
  mViewPager.setAdapter(new TvShowEpisodeDetailsAdapter(getSupportFragmentManager()));
  mViewPager.setOnPageChangeListener(new ViewPager.SimpleOnPageChangeListener(){
    @Override public void onPageSelected(    int position){
      updateActionBar(position);
      updateActionBarDrawable(1,true,false);
    }
  }
);
  if (savedInstanceState != null) {
    mViewPager.setCurrentItem(savedInstanceState.getInt("tab",0));
  }
 else {
    for (int i=0; i < mEpisodes.size(); i++) {
      if (mEpisodes.get(i).getSeason().equals(MizLib.addIndexZero(mSeason)) && mEpisodes.get(i).getEpisode().equals(MizLib.addIndexZero(mEpisode))) {
        mViewPager.setCurrentItem(i);
        updateActionBar(i);
        continue;
      }
    }
  }
}
