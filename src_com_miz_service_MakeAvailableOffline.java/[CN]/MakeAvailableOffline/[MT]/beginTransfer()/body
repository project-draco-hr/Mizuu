{
  if (file.startsWith("http")) {
    int bufferSize=16384;
    byte[] retVal=null;
    InputStream in=null;
    OutputStream fileos=null;
    OkHttpClient client=new OkHttpClient();
    HttpURLConnection urlConnection=null;
    try {
      totalLength=MizLib.getFileSize(new URL(file));
      urlConnection=client.open(new URL(file));
      File offline=MizLib.getOfflineFile(mContext,file);
      offline.createNewFile();
      fileos=new BufferedOutputStream(new FileOutputStream(offline));
      in=new BufferedInputStream(urlConnection.getInputStream(),bufferSize);
      retVal=new byte[bufferSize];
      int length=0;
      while ((length=in.read(retVal)) > -1) {
        if (mStopDownload) {
          fileos.close();
          in.close();
          return false;
        }
        fileos.write(retVal,0,length);
        currentLength+=length;
        update();
      }
      return true;
    }
 catch (    IOException e) {
      return false;
    }
 finally {
      if (fileos != null) {
        try {
          fileos.flush();
          fileos.close();
        }
 catch (        IOException e) {
        }
      }
      if (in != null) {
        try {
          in.close();
        }
 catch (        IOException e) {
        }
      }
      if (urlConnection != null)       urlConnection.disconnect();
    }
  }
 else {
    try {
      File offline=MizLib.getOfflineFile(mContext,smb.getCanonicalPath());
      offline.createNewFile();
      totalLength=smb.length();
      OutputStream os=new BufferedOutputStream(new FileOutputStream(offline),16384);
      BufferedInputStream in=new BufferedInputStream(new SmbFileInputStream(smb),16384);
      byte[] b=new byte[16384];
      int n;
      while ((n=in.read(b)) != -1) {
        if (mStopDownload) {
          os.close();
          in.close();
          return false;
        }
        os.write(b,0,n);
        currentLength+=n;
        update();
      }
      os.close();
      in.close();
      return true;
    }
 catch (    Exception ignored) {
      return false;
    }
  }
}
