{
  AlertDialog.Builder builder=new AlertDialog.Builder(this);
  View dialogLayout=getLayoutInflater().inflate(R.layout.delete_file_dialog_layout,null);
  final CheckBox cb=(CheckBox)dialogLayout.findViewById(R.id.deleteFile);
  if (mMovie.isUpnpFile())   cb.setEnabled(false);
 else   cb.setChecked(PreferenceManager.getDefaultSharedPreferences(this).getBoolean(ALWAYS_DELETE_FILE,false));
  builder.setTitle(getString(R.string.removeMovie)).setView(dialogLayout).setCancelable(false).setPositiveButton(getString(android.R.string.yes),new DialogInterface.OnClickListener(){
    public void onClick(    DialogInterface dialog,    int id){
      boolean deleted=true;
      if (mMovie.hasMultipleVersions()) {
        MovieVersion[] versions=mMovie.getMultipleVersions();
        for (int i=0; i < versions.length; i++) {
          if (mIgnoreDeletedFiles)           deleted=deleted && mDatabase.ignoreMovie(Long.valueOf(versions[i].getRowId()));
 else           deleted=deleted && mDatabase.deleteMovie(Long.valueOf(versions[i].getRowId()));
        }
      }
 else {
        if (mIgnoreDeletedFiles)         deleted=mDatabase.ignoreMovie(Long.valueOf(mMovie.getRowId()));
 else         deleted=mDatabase.deleteMovie(Long.valueOf(mMovie.getRowId()));
      }
      if (deleted) {
        if (cb.isChecked()) {
          if (mMovie.hasMultipleVersions()) {
            MovieVersion[] versions=mMovie.getMultipleVersions();
            for (int i=0; i < versions.length; i++) {
              Intent deleteIntent=new Intent(getApplicationContext(),DeleteFile.class);
              deleteIntent.putExtra("filepath",versions[i].getFilepath());
              getApplicationContext().startService(deleteIntent);
            }
          }
 else {
            Intent deleteIntent=new Intent(getApplicationContext(),DeleteFile.class);
            deleteIntent.putExtra("filepath",mMovie.getFilepath());
            getApplicationContext().startService(deleteIntent);
          }
        }
        boolean movieExists=mDatabase.movieExists(mMovie.getTmdbId());
        if (!movieExists) {
          try {
            File coverArt=mMovie.getPoster();
            if (coverArt.exists() && coverArt.getAbsolutePath().contains("com.miz.mizuu")) {
              MizLib.deleteFile(coverArt);
            }
          }
 catch (          NullPointerException e) {
          }
          try {
            File thumbnail=mMovie.getThumbnail();
            if (thumbnail.exists() && thumbnail.getAbsolutePath().contains("com.miz.mizuu")) {
              MizLib.deleteFile(thumbnail);
            }
          }
 catch (          NullPointerException e) {
          }
          try {
            File backdrop=new File(mMovie.getBackdrop());
            if (backdrop.exists() && backdrop.getAbsolutePath().contains("com.miz.mizuu")) {
              MizLib.deleteFile(backdrop);
            }
          }
 catch (          NullPointerException e) {
          }
        }
        notifyDatasetChanges();
        finish();
        return;
      }
 else {
        Toast.makeText(getApplicationContext(),getString(R.string.failedToRemoveMovie),Toast.LENGTH_SHORT).show();
      }
    }
  }
).setNegativeButton(getString(android.R.string.no),new DialogInterface.OnClickListener(){
    public void onClick(    DialogInterface dialog,    int id){
      dialog.cancel();
    }
  }
).create().show();
}
