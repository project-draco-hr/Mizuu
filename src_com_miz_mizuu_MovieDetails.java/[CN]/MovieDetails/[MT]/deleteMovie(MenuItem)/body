{
  AlertDialog.Builder builder=new AlertDialog.Builder(this);
  View dialogLayout=getLayoutInflater().inflate(R.layout.delete_file_dialog_layout,null);
  final CheckBox cb=(CheckBox)dialogLayout.findViewById(R.id.deleteFile);
  cb.setChecked(PreferenceManager.getDefaultSharedPreferences(this).getBoolean("prefsAlwaysDeleteFile",false));
  builder.setTitle(getString(R.string.removeMovie)).setView(dialogLayout).setCancelable(false).setPositiveButton(getString(android.R.string.yes),new DialogInterface.OnClickListener(){
    public void onClick(    DialogInterface dialog,    int id){
      boolean deleted=true;
      if (thisMovie.hasMultipleVersions()) {
        MovieVersion[] versions=thisMovie.getMultipleVersions();
        for (int i=0; i < versions.length; i++) {
          if (ignoreDeletedFiles)           deleted=deleted && db.ignoreMovie(Long.valueOf(versions[i].getRowId()));
 else           deleted=deleted && db.deleteMovie(Long.valueOf(versions[i].getRowId()));
        }
      }
 else {
        if (ignoreDeletedFiles)         deleted=db.ignoreMovie(Long.valueOf(thisMovie.getRowId()));
 else         deleted=db.deleteMovie(Long.valueOf(thisMovie.getRowId()));
      }
      if (deleted) {
        if (cb.isChecked()) {
          if (thisMovie.hasMultipleVersions()) {
            MovieVersion[] versions=thisMovie.getMultipleVersions();
            for (int i=0; i < versions.length; i++) {
              Intent deleteIntent=new Intent(getApplicationContext(),DeleteFile.class);
              deleteIntent.putExtra("filepath",versions[i].getFilepath());
              getApplicationContext().startService(deleteIntent);
            }
          }
 else {
            Intent deleteIntent=new Intent(getApplicationContext(),DeleteFile.class);
            deleteIntent.putExtra("filepath",thisMovie.getFilepath());
            getApplicationContext().startService(deleteIntent);
          }
        }
        boolean movieExists=db.movieExists(thisMovie.getTmdbId());
        if (!movieExists) {
          try {
            File coverArt=new File(thisMovie.getPoster());
            if (coverArt.exists() && coverArt.getAbsolutePath().contains("com.miz.mizuu")) {
              MizLib.deleteFile(coverArt);
            }
          }
 catch (          NullPointerException e) {
          }
          try {
            File thumbnail=new File(thisMovie.getThumbnail());
            if (thumbnail.exists() && thumbnail.getAbsolutePath().contains("com.miz.mizuu")) {
              MizLib.deleteFile(thumbnail);
            }
          }
 catch (          NullPointerException e) {
          }
          try {
            File backdrop=new File(thisMovie.getBackdrop());
            if (backdrop.exists() && backdrop.getAbsolutePath().contains("com.miz.mizuu")) {
              MizLib.deleteFile(backdrop);
            }
          }
 catch (          NullPointerException e) {
          }
        }
        notifyDatasetChanges();
        finish();
        return;
      }
 else {
        Toast.makeText(getApplicationContext(),getString(R.string.failedToRemoveMovie),Toast.LENGTH_SHORT).show();
      }
    }
  }
).setNegativeButton(getString(android.R.string.no),new DialogInterface.OnClickListener(){
    public void onClick(    DialogInterface dialog,    int id){
      dialog.cancel();
    }
  }
).create().show();
}
